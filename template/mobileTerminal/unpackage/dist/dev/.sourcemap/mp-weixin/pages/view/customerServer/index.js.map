{"version":3,"sources":["webpack:///G:/workOfzhongbang/客服系统/gitee/CRMChat/template/mobileTerminal/pages/view/customerServer/index.vue?633f","webpack:///G:/workOfzhongbang/客服系统/gitee/CRMChat/template/mobileTerminal/pages/view/customerServer/index.vue?5942","uni-app:///pages/view/customerServer/index.vue","webpack:///G:/workOfzhongbang/客服系统/gitee/CRMChat/template/mobileTerminal/pages/view/customerServer/index.vue?76d9","webpack:///G:/workOfzhongbang/客服系统/gitee/CRMChat/template/mobileTerminal/pages/view/customerServer/index.vue?414d","uni-app:///main.js","webpack:///G:/workOfzhongbang/客服系统/gitee/CRMChat/template/mobileTerminal/pages/view/customerServer/index.vue?e487","webpack:///G:/workOfzhongbang/客服系统/gitee/CRMChat/template/mobileTerminal/pages/view/customerServer/index.vue?dfa5"],"names":["createPage","Page"],"mappings":"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","file":"pages/view/customerServer/index.js","sourcesContent":["var components\ntry {\n  components = {\n    uniPopup: function() {\n      return import(\n        /* webpackChunkName: \"uni_modules/uni-popup/components/uni-popup/uni-popup\" */ \"@/uni_modules/uni-popup/components/uni-popup/uni-popup.vue\"\n      )\n    }\n  }\n} catch (e) {\n  if (\n    e.message.indexOf(\"Cannot find module\") !== -1 &&\n    e.message.indexOf(\".vue\") !== -1\n  ) {\n    console.error(e.message)\n    console.error(\"1. 排查组件名称拼写是否正确\")\n    console.error(\n      \"2. 排查组件是否符合 easycom 规范，文档：https://uniapp.dcloud.net.cn/collocation/pages?id=easycom\"\n    )\n    console.error(\n      \"3. 若组件不符合 easycom 规范，需手动引入，并在 components 中注册该组件\"\n    )\n  } else {\n    throw e\n  }\n}\nvar render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  var l0 = _vm.__map(_vm.messageList, function(item, index) {\n    var $orig = _vm.__get_orig(item)\n\n    var m0 = item.msn_type <= 2 ? _vm.replace_em(item.msn) : null\n    var m1 = item.msn_type == 5 ? parseInt(item.other.sales) : null\n    var m2 =\n      item.msn_type == 5\n        ? parseInt(item.other.ficti ? item.other.ficti : 0)\n        : null\n    return {\n      $orig: $orig,\n      m0: m0,\n      m1: m1,\n      m2: m2\n    }\n  })\n\n  if (!_vm._isMounted) {\n    _vm.e0 = function($event) {\n      _vm.selectModel = 0\n    }\n  }\n\n  _vm.$mp.data = Object.assign(\n    {},\n    {\n      $root: {\n        l0: l0\n      }\n    }\n  )\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!D:\\\\我需要的工具\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!D:\\\\我需要的工具\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--12-1!D:\\\\我需要的工具\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!D:\\\\我需要的工具\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\我需要的工具\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!D:\\\\我需要的工具\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!D:\\\\我需要的工具\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--12-1!D:\\\\我需要的工具\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!D:\\\\我需要的工具\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\我需要的工具\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./index.vue?vue&type=script&lang=js&\"","<template>\r\n\t<div class=\"container\">\r\n\t\t<lay-out ref=\"layOut\" :scrollTop=\"scrollTop\" refresherEnabled @refresherrefresh=\"refresherrefresh\" :refresherTriggered=\"refresherTriggered\">\r\n\t\t\t<div slot=\"header\" class=\"header\">\r\n\t\t\t\t<div class=\"header_left\" @click=\"goBackToMessageList\"><span class=\"iconfont icon-fanhui\"></span></div>\r\n\t\t\t\t<div class=\"header_center\">{{ userData.nickname }}</div>\r\n\t\t\t\t<!-- <div class=\"header_right\"><span class=\"iconfont\">&#xe6e3;</span></div> -->\r\n\t\t\t\t<div></div>\r\n\t\t\t</div>\r\n\t\t\t<div slot=\"content\" class=\"content\">\r\n\t\t\t\t<div class=\"content_list\" v-for=\"(item, index) in messageList\" :key=\"index\" :class=\"{ right_box: item.user_id == customerServerData.user_id }\">\r\n\t\t\t\t\t<div class=\"content_list_avar\" @click=\"selectCustomerServer(item)\"><image :src=\"item.avatar\" mode=\"widthFix\"></image></div>\r\n\t\t\t\t\t<div class=\"content_list_message\">\r\n\t\t\t\t\t\t<div class=\"content_list_message_value\" v-if=\"item.msn_type <= 2\"><span v-html=\"replace_em(item.msn)\"></span></div>\r\n\r\n\t\t\t\t\t\t<div class=\"content_list_message_product\" v-if=\"item.msn_type == 5\">\r\n\t\t\t\t\t\t\t<div class=\"content_list_message_orderId\">\r\n\t\t\t\t\t\t\t\t<span class=\"content_list_message_orderId_label\">商品名称:</span>\r\n\t\t\t\t\t\t\t\t<span class=\"content_list_message_orderId_value\">{{ item.other.store_name }}</span>\r\n\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t<div class=\"content_list_message_detils\">\r\n\t\t\t\t\t\t\t\t<div class=\"content_list_message_detils_image\"><image :src=\"item.other.image\" mode=\"widthFix\"></image></div>\r\n\t\t\t\t\t\t\t\t<div class=\"content_list_message_detils_value\">\r\n\t\t\t\t\t\t\t\t\t<div class=\"content_list_message_detils_value_shopMessag\">\r\n\t\t\t\t\t\t\t\t\t\t<div class=\"content_list_message_detils_value_shopMessag_item\">\r\n\t\t\t\t\t\t\t\t\t\t\t<div class=\"content_list_message_detils_value_shopMessag_item_label\"><span>库存:</span></div>\r\n\t\t\t\t\t\t\t\t\t\t\t<div class=\"content_list_message_detils_value_shopMessag_item_value\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<span>{{ item.other.stock }}</span>\r\n\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t<div class=\"content_list_message_detils_value_shopMessag_item\">\r\n\t\t\t\t\t\t\t\t\t\t\t<div class=\"content_list_message_detils_value_shopMessag_item_label\"><span>销量:</span></div>\r\n\t\t\t\t\t\t\t\t\t\t\t<div class=\"content_list_message_detils_value_shopMessag_item_value\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<span>{{ parseInt(item.other.sales) + parseInt(item.other.ficti ? item.other.ficti : 0) }}</span>\r\n\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t<!-- <span>{{ item.other }}</span> -->\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t<div class=\"content_list_message_detils_value_shopPrice\">\r\n\t\t\t\t\t\t\t\t\t\t<span>￥{{ item.other.price }}</span>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t<div class=\"content_list_message_image\" v-if=\"item.msn_type == 3\"><image :src=\"item.msn\" mode=\"widthFix\"></image></div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\r\n\t\t\t<div slot=\"bottom\" class=\"footer\" :class=\"{ translateY0: selectModel }\">\r\n\t\t\t\t<div class=\"footer_input\">\r\n\t\t\t\t\t<div class=\"footer_input_icon mr18\" @click=\"selectScriptLibary\"><span class=\"iconfont\">&#xe6b8;</span></div>\r\n\t\t\t\t\t<div class=\"footer_input_content mr18\">\r\n\t\t\t\t\t\t<textarea v-model=\"sendMessage\" @input=\"textareaChange($event)\" @focus=\"selectModel = 0\" class=\"font\" value=\"\" placeholder=\"\" />\r\n\t\t\t\t\t\t<p v-html=\"pCont\" class=\"font\"></p>\r\n\t\t\t\t\t\t<span class=\"iconfont\" @click=\"sendText\">&#xe6bb;</span>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div class=\"footer_input_icon\">\r\n\t\t\t\t\t\t<span class=\"iconfont mr18\" @click=\"selectOption(1)\">&#xe6cb;</span>\r\n\t\t\t\t\t\t<span class=\"iconfont\" @click=\"selectOption(2)\">&#xe6c2;</span>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t<div class=\"footer_option\" :style=\"{ height: selectModel ? '440rpx' : '0' }\">\r\n\t\t\t\t\t<div class=\"option\" v-if=\"selectModel == 2\">\r\n\t\t\t\t\t\t<div @click=\"uploadImage\">\r\n\t\t\t\t\t\t\t<image src=\"~static/image/messageList/picture.png\" mode=\"widthFix\"></image>\r\n\t\t\t\t\t\t\t<div>图片</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div @click=\"transfer\">\r\n\t\t\t\t\t\t\t<image src=\"~static/image/messageList/connection.png\" mode=\"widthFix\"></image>\r\n\t\t\t\t\t\t\t<div>转接</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t<scroll-view class=\"emoji\" v-if=\"selectModel == 1\" scroll-y>\r\n\t\t\t\t\t\t<div class=\"emoji-item\" v-for=\"(item, index) in emoji\" :key=\"index\" @click=\"sendEmoji(item)\"><i class=\"em\" :class=\"item\"></i></div>\r\n\t\t\t\t\t</scroll-view>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</lay-out>\r\n\r\n\t\t<uni-popup ref=\"transferModel\" animation type=\"bottom\"><transfer @close=\"transferModelClose\" @handleSubmit=\"handleSubmitTransfer\"></transfer></uni-popup>\r\n\r\n\t\t<uni-popup ref=\"scriptLibaryModel\" animation type=\"bottom\">\r\n\t\t\t<div class=\"scriptLibary\">\r\n\t\t\t\t<div class=\"scriptLibary_header\">\r\n\t\t\t\t\t<div class=\"scriptLibary_header_title\">\r\n\t\t\t\t\t\t<div v-for=\"(item, index) in speechArtTypeList\" :key=\"index\" @click=\"selectSpeechArtType(item)\" :class=\"{ speechArtSelectEd: speechArtType == item.id }\">\r\n\t\t\t\t\t\t\t<span>{{ item.label }}</span>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t<div class=\"scriptLibary_header_icon\">\r\n\t\t\t\t\t\t<div @click=\"editScript\"><span class=\"iconfont\">&#xe6b4;</span></div>\r\n\t\t\t\t\t\t<div @click=\"closeScript\"><span class=\"iconfont\">&#xe6b5;</span></div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div class=\"scriptLibary_search\">\r\n\t\t\t\t\t<div>\r\n\t\t\t\t\t\t<span @click=\"handleSetTitle\" class=\"iconfont\">&#xe6d8;</span>\r\n\t\t\t\t\t\t<input v-model=\"scriptTitle\" type=\"text\" placeholder=\"搜索快捷回复\" />\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div class=\"scriptLibary_content\">\r\n\t\t\t\t\t<scripts-libary\r\n\t\t\t\t\t\t:tagList=\"speechTagList\"\r\n\t\t\t\t\t\t:speechArtType=\"speechArtType\"\r\n\t\t\t\t\t\tmaxHeight=\"900rpx\"\r\n\t\t\t\t\t\theight=\"800rpx\"\r\n\t\t\t\t\t\t:title=\"scriptTitle\"\r\n\t\t\t\t\t\t@sendSpeechMessage=\"sendSpeechMessage\"\r\n\t\t\t\t\t></scripts-libary>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</uni-popup>\r\n\t</div>\r\n</template>\r\n\r\n<script>\r\nimport emoji from 'pages/utils/emoji.js';\r\nimport { navigateBack, navigateTo, getStorage, serialize, chooseImage } from 'pages/utils/uniApi.js';\r\nimport transfer from './component/transfer.vue';\r\nimport scriptsLibary from './component/scriptLibary.vue';\r\nimport http from 'pages/api/index';\r\nimport api from 'pages/api/api.js';\r\n\r\nexport default {\r\n\tcomponents: {\r\n\t\ttransfer, // 转接客服\r\n\t\tscriptsLibary // 话术库\r\n\t},\r\n\tdata() {\r\n\t\treturn {\r\n\t\t\tpCont: '',\r\n\t\t\tsendMessage: '', // 发送的消息\r\n\t\t\tselectModel: 0, // 1:选择表情 2: 功能选择（转接，上传图片）\r\n\t\t\temoji: [],\r\n\t\t\tmessageList: [],\r\n\t\t\tuserData: {},\r\n\t\t\tpageData: {\r\n\t\t\t\tlimit: 20,\r\n\t\t\t\tupperId: 0\r\n\t\t\t},\r\n\t\t\tspeechArtType: 1, // 0 全局 1 私有\r\n\t\t\tspeechTagList: [], // 话术分类\r\n\t\t\tscriptTitle: '', // 搜索输入的内容\r\n\t\t\tpropstitle: '',\r\n\t\t\tspeechArtTypeList: [\r\n\t\t\t\t{\r\n\t\t\t\t\tid: 1,\r\n\t\t\t\t\tlabel: '个人库'\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\tid: 0,\r\n\t\t\t\t\tlabel: '公共库'\r\n\t\t\t\t}\r\n\t\t\t],\r\n\t\t\tcustomerServerData: {},\r\n\t\t\tscrollTop: 0, // 滚动位置\r\n\t\t\trefresherTriggered: true, // 下拉刷新装状态\r\n\t\t\taudioFun: '' // 音频对象\r\n\t\t};\r\n\t},\r\n\tasync onLoad(opt) {\r\n\t\tthis.emoji = emoji;\r\n\t\tthis.userData = opt; // 获取用户信息\r\n\t\tthis.customerServerData = getStorage('userData').kefuInfo;\r\n\r\n\t\tawait this.initData();\r\n\t\tthis.initAudio();\r\n\t\tthis.sockEventListenr();\r\n\t\tthis.$nextTick(() => {\r\n\t\t\tthis.goBottom();\r\n\t\t});\r\n\t},\r\n\tmethods: {\r\n\t\t// socket监听\r\n\t\tsockEventListenr() {\r\n\t\t\tthis.scoket.send({\r\n\t\t\t\tdata: {\r\n\t\t\t\t\tid: this.userData.to_user_id\r\n\t\t\t\t},\r\n\t\t\t\ttype: 'to_chat'\r\n\t\t\t});\r\n\r\n\t\t\tthis.scoket.onMessage(data => {\r\n\t\t\t\tswitch (data.type) {\r\n\t\t\t\t\tcase 'reply':\r\n\t\t\t\t\tcase 'chat':\r\n\t\t\t\t\t\tthis.pushMessageToList(data.data);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'mssage_num':\r\n\t\t\t\t\t\tif (data.data.num > 0) {\r\n\t\t\t\t\t\t\tthis.audioFun.play();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\r\n\t\t\t\t\tdefault:\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\r\n\t\t// 初始化音频\r\n\t\tinitAudio() {\r\n\t\t\tthis.audioFun = uni.createInnerAudioContext();\r\n\t\t\t// this.audioFun.autoplay = false;\r\n\t\t\tthis.audioFun.src = '../../../static/video/notice.wav';\r\n\t\t},\r\n\r\n\t\t// 获取聊天列表\r\n\t\tasync initData() {\r\n\t\t\treturn await http(api.kefuServiceList, {\r\n\t\t\t\tuser_id: this.userData.to_user_id,\r\n\t\t\t\t...this.pageData\r\n\t\t\t}).then(res => {\r\n\t\t\t\tthis.messageList = res.concat(this.messageList);\r\n\t\t\t\tthis.pageData.upperId = this.messageList.length ? this.messageList[0].id : 0;\r\n\t\t\t\tthis.refresherTriggered = false;\r\n\t\t\t});\r\n\t\t},\r\n\t\t// 触发下拉刷新\r\n\t\trefresherrefresh() {\r\n\t\t\tthis.refresherTriggered = true;\r\n\t\t\tthis.initData();\r\n\t\t},\r\n\t\t// 发送文本消息\r\n\t\tsendText() {\r\n\t\t\tthis.sendMsg(this.sendMessage, 1);\r\n\t\t\tthis.sendMessage = '';\r\n\t\t},\r\n\t\t// 选择表情\r\n\t\tsendEmoji(item) {\r\n\t\t\tthis.sendMessage += `[${item}]`;\r\n\t\t},\r\n\t\t// 发送图片\r\n\t\tuploadImage() {\r\n\t\t\tchooseImage(1).then(res => {\r\n\t\t\t\tuni.uploadFile({\r\n\t\t\t\t\turl: api.kefuUploadAvatar.url,\r\n\t\t\t\t\tfilePath: res.tempFilePaths[0],\r\n\t\t\t\t\tname: 'file',\r\n\t\t\t\t\tformData: {\r\n\t\t\t\t\t\t// file: res.tempFilePaths[0],\r\n\t\t\t\t\t\tfilename: 'file'\r\n\t\t\t\t\t},\r\n\t\t\t\t\theader: {\r\n\t\t\t\t\t\t// #ifdef MP || APP-PLUS\r\n\t\t\t\t\t\t'Content-Type': 'multipart/form-data',\r\n\t\t\t\t\t\t// #endif\r\n\t\t\t\t\t\t'Authori-zation': 'Bearer ' + getStorage('userData').token\r\n\t\t\t\t\t},\r\n\t\t\t\t\tsuccess: uploadFileRes => {\r\n\t\t\t\t\t\tlet unloadResponse = JSON.parse(uploadFileRes.data);\r\n\t\t\t\t\t\tif (unloadResponse.status == 200) {\r\n\t\t\t\t\t\t\tthis.sendMsg(unloadResponse.data.url, 3);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\tcomplete: res => {\r\n\t\t\t\t\t\tconsole.log(res);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t},\r\n\t\tpushMessageToList(data) {\r\n\t\t\tthis.messageList.push(data);\r\n\t\t\tthis.goBottom();\r\n\t\t},\r\n\t\tgoBottom() {\r\n\t\t\tconst query = uni.createSelectorQuery().in(this);\r\n\t\t\tquery\r\n\t\t\t\t.select('.content')\r\n\t\t\t\t.boundingClientRect(data => {\r\n\t\t\t\t\tthis.$nextTick(() => {\r\n\t\t\t\t\t\tthis.scrollTop = data.height;\r\n\t\t\t\t\t});\r\n\t\t\t\t})\r\n\t\t\t\t.exec();\r\n\t\t},\r\n\t\t// 发送消息统一处理\r\n\t\tsendMsg(msn, type) {\r\n\t\t\tlet obj = {\r\n\t\t\t\ttype: 'chat',\r\n\t\t\t\tdata: {\r\n\t\t\t\t\tmsn,\r\n\t\t\t\t\ttype,\r\n\t\t\t\t\tto_user_id: this.userData.to_user_id\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t\tthis.scoket.send(obj);\r\n\t\t},\r\n\t\t// 查询话术类\r\n\t\tselectScriptLibary() {\r\n\t\t\thttp(api.kefuServiceCate, {\r\n\t\t\t\ttype: this.speechArtType\r\n\t\t\t}).then(res => {\r\n\t\t\t\tthis.speechTagList = res.data;\r\n\t\t\t\tthis.$refs.scriptLibaryModel.open();\r\n\t\t\t});\r\n\t\t},\r\n\t\t// 选择话术库，个人，工共\r\n\t\tselectSpeechArtType(item) {\r\n\t\t\tthis.speechArtType = item.id;\r\n\t\t\tthis.selectScriptLibary();\r\n\t\t},\r\n\t\t// 选中话术\r\n\t\tsendSpeechMessage(item) {\r\n\t\t\tthis.sendMessage = item.message;\r\n\t\t\tthis.$refs.scriptLibaryModel.close(); // 关闭话术库弹框\r\n\t\t},\r\n\t\t// 关闭话术弹框\r\n\t\tcloseScript() {\r\n\t\t\tthis.$refs.scriptLibaryModel.close();\r\n\t\t},\r\n\t\t// 修改话术库\r\n\t\teditScript() {\r\n\t\t\tthis.$refs.scriptLibaryModel.close();\r\n\t\t\tnavigateTo(1, '/pages/view/customerServer/script', { speechArtType: this.speechArtType });\r\n\t\t},\r\n\t\t// 话术搜索\r\n\t\thandleSetTitle() {\r\n\t\t\tthis.propstitle = serialize(this.scriptTitle);\r\n\t\t},\r\n\t\t// 转接\r\n\t\ttransfer() {\r\n\t\t\tthis.selectModel = 0;\r\n\t\t\tthis.$refs.transferModel.open();\r\n\t\t},\r\n\t\t// 确认转接\r\n\t\thandleSubmitTransfer() {\r\n\t\t\tthis.$refs.transferModel.close();\r\n\t\t},\r\n\t\t// 关闭转接弹框\r\n\t\ttransferModelClose() {\r\n\t\t\tthis.$refs.transferModel.close();\r\n\t\t},\r\n\t\t// 头部方法，回到聊天列表页\r\n\t\tgoBackToMessageList() {\r\n\t\t\tnavigateTo(2, '/pages/view/messageList/index');\r\n\t\t},\r\n\t\t// 查看用户详情\r\n\t\tselectCustomerServer(item) {\r\n\t\t\tif (item.type == 1) {\r\n\t\t\t\tnavigateTo(1, '/pages/view/customerServer/customerMessage', item);\r\n\t\t\t}\r\n\t\t},\r\n\t\t// 选择上传图片，转接\r\n\t\tselectOption(item) {\r\n\t\t\tthis.selectModel = item;\r\n\t\t},\r\n\t\t// 聊天表情转换\r\n\t\treplace_em(str) {\r\n\t\t\tstr = str.replace(/\\[em-([a-z_]*)\\]/g, \"<span class='em em-$1'/></span>\");\r\n\t\t\treturn str;\r\n\t\t},\r\n\t\ttextareaChange(e) {\r\n\t\t\tlet strCont = e.target.value.replace(/\\n\\s(\\s)*/gi, '\\n'); // 将多个回车换行合并为 1个\r\n\t\t\tstrCont = strCont.replace(/^\\s*/gi, ''); // 清除首行的 空格与换行\r\n\t\t\tlet strHtml = strCont.replace(/</gi, '&lt;'); // 将所有的 < 转义为 &lt; 防止html标签被转义\r\n\t\t\tstrHtml = strCont.replace(/\\n(\\n)*/gi, '<br>'); // 回车换行替换为 <br>\r\n\t\t\tstrHtml = strHtml.replace(/\\s+/gi, '&nbsp;'); // 一个或过个空格 替换为 &nbsp;\r\n\t\t\tstrCont = strHtml.replace(/&nbsp;/gi, ' '); // 逆向处理\r\n\t\t\tstrCont = strCont.replace(/<br>/gi, '\\n'); // 逆向处理\r\n\t\t\tstrCont = strCont.replace(/&lt;/gi, '<');\r\n\t\t\t/** 如果 p 标签最后的字符为 <br> 并不会单独另起一行, 会导致与 textarea 的高度相差一行,\r\n\t\t\t * 所以在最后添加一个字符, 这样就能保证 P 标签的高度与 textarea 的高度一致\r\n\t\t\t */\r\n\t\t\tthis.pCont = strHtml + '.';\r\n\t\t}\r\n\t}\r\n};\r\n</script>\r\n\r\n<style scoped lang=\"less\">\r\n@import './less/customerServer.less';\r\n@import './less/scriptLibary.less';\r\n</style>\n","import mod from \"-!D:\\\\我需要的工具\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\mini-css-extract-plugin\\\\dist\\\\loader.js??ref--10-oneOf-1-0!D:\\\\我需要的工具\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\css-loader\\\\dist\\\\cjs.js??ref--10-oneOf-1-1!D:\\\\我需要的工具\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\stylePostLoader.js!D:\\\\我需要的工具\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--10-oneOf-1-2!D:\\\\我需要的工具\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\postcss-loader\\\\src\\\\index.js??ref--10-oneOf-1-3!D:\\\\我需要的工具\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\less-loader\\\\dist\\\\cjs.js??ref--10-oneOf-1-4!D:\\\\我需要的工具\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--10-oneOf-1-5!D:\\\\我需要的工具\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\我需要的工具\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./index.vue?vue&type=style&index=0&id=afab33f6&scoped=true&lang=less&\"; export default mod; export * from \"-!D:\\\\我需要的工具\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\mini-css-extract-plugin\\\\dist\\\\loader.js??ref--10-oneOf-1-0!D:\\\\我需要的工具\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\css-loader\\\\dist\\\\cjs.js??ref--10-oneOf-1-1!D:\\\\我需要的工具\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\stylePostLoader.js!D:\\\\我需要的工具\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--10-oneOf-1-2!D:\\\\我需要的工具\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\postcss-loader\\\\src\\\\index.js??ref--10-oneOf-1-3!D:\\\\我需要的工具\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\less-loader\\\\dist\\\\cjs.js??ref--10-oneOf-1-4!D:\\\\我需要的工具\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--10-oneOf-1-5!D:\\\\我需要的工具\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\我需要的工具\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./index.vue?vue&type=style&index=0&id=afab33f6&scoped=true&lang=less&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1627963167927\n      var cssReload = require(\"D:/我需要的工具/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"../../\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  ","import 'uni-pages';\nimport Vue from 'vue'\nimport Page from './pages/view/customerServer/index.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./index.vue?vue&type=template&id=afab33f6&scoped=true&\"\nvar renderjs\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\nimport style0 from \"./index.vue?vue&type=style&index=0&id=afab33f6&scoped=true&lang=less&\"\n\n\n/* normalize component */\nimport normalizer from \"!D:\\\\我需要的工具\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\runtime\\\\componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"afab33f6\",\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"pages/view/customerServer/index.vue\"\nexport default component.exports","export * from \"-!D:\\\\我需要的工具\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\templateLoader.js??vue-loader-options!D:\\\\我需要的工具\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--16-0!D:\\\\我需要的工具\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\template.js!D:\\\\我需要的工具\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-uni-app-loader\\\\page-meta.js!D:\\\\我需要的工具\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\我需要的工具\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./index.vue?vue&type=template&id=afab33f6&scoped=true&\""],"sourceRoot":""}
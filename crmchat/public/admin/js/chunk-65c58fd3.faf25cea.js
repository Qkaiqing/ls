(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-65c58fd3"],{"5b9e":function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"i-layout-page-header"},[a("div",{staticClass:"i-layout-page-header"},[a("span",{staticClass:"ivu-page-header-title"},[t._v(t._s(t.$route.meta.title))])])]),a("Card",{staticClass:"ivu-mt",attrs:{bordered:!1,"dis-hover":""}},[a("div",{staticClass:"table_box"},[a("Form",{ref:"formValidate",staticClass:"tabform",attrs:{model:t.formValidate,"label-width":t.labelWidth,"label-position":t.labelPosition},nativeOn:{submit:function(t){t.preventDefault()}}},[a("Row",{attrs:{gutter:24,type:"flex",justify:"end"}},[a("Col",{staticClass:"ivu-text-left",attrs:{span:"24"}},[a("FormItem",{attrs:{label:t.fromList.title+"："}},[a("RadioGroup",{staticClass:"mr15",attrs:{type:"button"},on:{"on-change":function(e){return t.selectChange(t.formValidate.data)}},model:{value:t.formValidate.data,callback:function(e){t.$set(t.formValidate,"data",e)},expression:"formValidate.data"}},t._l(t.fromList.fromTxt,(function(e,s){return a("Radio",{key:s,attrs:{label:e.val}},[t._v("\n                                    "+t._s(e.text)+"\n                                ")])})),1),a("DatePicker",{staticStyle:{width:"200px"},attrs:{editable:!1,value:t.timeVal,format:"yyyy/MM/dd",type:"daterange",placement:"bottom-end",placeholder:"自定义时间"},on:{"on-change":t.onchangeTime}})],1)],1),a("Col",{staticClass:"ivu-text-left",attrs:{span:"24"}},[a("FormItem",{attrs:{label:"用户分组："}},[a("RadioGroup",{attrs:{type:"button"},model:{value:t.formValidate.groupid,callback:function(e){t.$set(t.formValidate,"groupid",e)},expression:"formValidate.groupid"}},t._l(t.groupList,(function(e,s){return a("Radio",{key:s,attrs:{label:e.id}},[t._v(t._s(e.name))])})),1)],1)],1),a("Col",{staticClass:"ivu-text-left",attrs:{span:"24"}},[a("FormItem",{attrs:{label:"用户标签："}},[a("TagSelect",{model:{value:t.tagidList,callback:function(e){t.tagidList=e},expression:"tagidList"}},t._l(t.tagList,(function(e,s){return a("TagSelectOption",{key:s,attrs:{name:e.id}},[t._v(t._s(e.name))])})),1)],1)],1),a("Col",{staticClass:"ivu-text-left",attrs:{span:"24"}},[a("Col",{attrs:{xl:7,lg:12,md:12,sm:24,xs:24}},[a("FormItem",{attrs:{label:"用户名称："}},[a("Input",{staticClass:"perW90",attrs:{placeholder:"请输入用户名称"},model:{value:t.formValidate.nickname,callback:function(e){t.$set(t.formValidate,"nickname",e)},expression:"formValidate.nickname"}})],1)],1),a("Col",{staticClass:"sex_box",attrs:{xl:7,lg:12,md:12,sm:24,xs:24}},[a("FormItem",{attrs:{label:"性别："}},[a("Select",{staticStyle:{width:"90%"},attrs:{clearable:""},model:{value:t.formValidate.sex,callback:function(e){t.$set(t.formValidate,"sex",e)},expression:"formValidate.sex"}},[a("Option",{attrs:{value:"1"}},[t._v("男")]),a("Option",{attrs:{value:"2"}},[t._v("女")]),a("Option",{attrs:{value:"0"}},[t._v("保密")])],1)],1)],1),a("Col",{staticClass:"subscribe_box",attrs:{xl:7,lg:12,md:12,sm:24,xs:24}},[a("FormItem",{attrs:{label:"是否关注公众号："}},[a("Select",{staticStyle:{width:"90%"},attrs:{clearable:""},model:{value:t.formValidate.subscribe,callback:function(e){t.$set(t.formValidate,"subscribe",e)},expression:"formValidate.subscribe"}},[a("Option",{attrs:{value:"1"}},[t._v("是")]),a("Option",{attrs:{value:"0"}},[t._v("否")])],1)],1)],1),a("Col",{staticClass:"btn_box",attrs:{xl:3,lg:3,md:3,sm:24,xs:24}},[a("FormItem",[a("Button",{staticClass:"userSearch",attrs:{type:"primary",icon:"ios-search",label:"default"},on:{click:t.userSearchs}},[t._v("搜索")])],1)],1)],1),a("Divider",{attrs:{dashed:""}}),a("Col",{attrs:{span:"24"}},[a("Button",{staticClass:"mr20",attrs:{type:"primary"},on:{click:t.onSend}},[t._v("发送优惠券")]),a("Button",{staticClass:"greens mr20",attrs:{size:"default"},on:{click:t.onSendPic}},[a("Icon",{attrs:{type:"md-list"}}),t._v("\n                            发送图文消息\n                        ")],1)],1)],1)],1)],1),a("Table",{ref:"selection",staticClass:"mt25",attrs:{columns:t.columns4,data:t.tabList,loading:t.loading,"no-data-text":"暂无数据","highlight-row":"","no-filtered-data-text":"暂无筛选结果"},on:{"on-selection-change":t.onSelectTab},scopedSlots:t._u([{key:"headimgurl",fn:function(t){var e=t.row;t.index;return[a("div",{directives:[{name:"viewer",rawName:"v-viewer"}],staticClass:"tabBox_img"},[a("img",{directives:[{name:"lazy",rawName:"v-lazy",value:e.headimgurl,expression:"row.headimgurl"}]})])]}},{key:"sex",fn:function(e){var s=e.row;return[a("span",{directives:[{name:"show",rawName:"v-show",value:1===s.sex,expression:"row.sex === 1"}]},[t._v("男")]),a("span",{directives:[{name:"show",rawName:"v-show",value:2===s.sex,expression:"row.sex === 2"}]},[t._v("女")]),a("span",{directives:[{name:"show",rawName:"v-show",value:0===s.sex,expression:"row.sex === 0"}]},[t._v("保密")])]}},{key:"country",fn:function(e){var s=e.row;return[a("span",[t._v(t._s(s.country+s.province+s.city))])]}},{key:"subscribe",fn:function(e){var s=e.row;return[a("span",{directives:[{name:"show",rawName:"v-show",value:1===s.subscribe,expression:"row.subscribe === 1"}]},[t._v("关注")]),a("span",{directives:[{name:"show",rawName:"v-show",value:0===s.subscribe,expression:"row.subscribe === 0"}]},[t._v("未关注")])]}},{key:"createModalFrame",fn:function(e){var s=e.row;return[[a("Dropdown",{on:{"on-click":function(e){return t.changeMenu(s,e)}}},[a("a",{attrs:{href:"javascript:void(0)"}},[t._v("操作\n                            "),a("Icon",{attrs:{type:"ios-arrow-down"}})],1),a("DropdownMenu",{attrs:{slot:"list"},slot:"list"},[a("DropdownItem",{directives:[{name:"show",rawName:"v-show",value:s.subscribe,expression:"row.subscribe"}],attrs:{name:"1"}},[t._v("修改分组")]),a("DropdownItem",{directives:[{name:"show",rawName:"v-show",value:s.subscribe,expression:"row.subscribe"}],attrs:{name:"2"}},[t._v("修改标签")]),a("DropdownItem",{directives:[{name:"show",rawName:"v-show",value:s.subscribe,expression:"row.subscribe"}],attrs:{name:"3"}},[t._v("同步标签")]),a("DropdownItem",{directives:[{name:"show",rawName:"v-show",value:!s.subscribe,expression:"!row.subscribe"}]},[t._v("无法操作")])],1)],1)]]}}])}),a("div",{staticClass:"acea-row row-right page"},[a("Page",{attrs:{total:t.total,"show-elevator":"","show-total":"","page-size":t.formValidate.limit},on:{"on-change":t.pageChange}})],1)],1),a("edit-from",{ref:"edits",attrs:{FromData:t.FromData},on:{submitFail:t.submitFail}}),a("send-from",{ref:"sends",attrs:{userIds:t.user_ids}}),a("Modal",{staticClass:"modelBox",attrs:{scrollable:"",title:"发送消息","z-index":100,width:"1200",height:"800","footer-hide":""},model:{value:t.modal13,callback:function(e){t.modal13=e},expression:"modal13"}},[t.modal13?a("news-category",{attrs:{isShowSend:t.isShowSend,userIds:t.user_ids,scrollerHeight:t.scrollerHeight,contentTop:t.contentTop,contentWidth:t.contentWidth,maxCols:t.maxCols}}):t._e()],1)],1)},i=[],r=(a("8e6e"),a("ac6a"),a("456d"),a("96cf"),a("3b8d")),o=a("bd86"),n=a("2f62"),l=a("b562"),c=a("c42b"),u=a("31b4"),d=a("a8e0");function m(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,s)}return a}function h(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?m(Object(a),!0).forEach((function(e){Object(o["a"])(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):m(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}var f={name:"user",components:{newsCategory:c["a"],editFrom:u["a"],sendFrom:d["a"]},data:function(){return{tagidList:[],isShowSend:!0,maxCols:4,scrollerHeight:"600",contentTop:"130",contentWidth:"98%",modal13:!1,timeVal:[],fromList:{title:"选择时间",custom:!0,fromTxt:[{text:"全部",val:""},{text:"今天",val:"today"},{text:"昨天",val:"yesterday"},{text:"最近7天",val:"lately7"},{text:"最近30天",val:"lately30"},{text:"本月",val:"month"},{text:"本年",val:"year"}]},formValidate:{limit:15,page:1,nickname:"",data:"",tagid_list:"",sex:"",groupid:0,subscribe:"",export:2},loading:!1,tabList:[],total:0,value2:"",grid:{xl:8,lg:8,md:8,sm:24,xs:24},columns4:[{type:"selection",min:60,align:"center"},{title:"ID",key:"uid"},{title:"微信用户名称",key:"nickname"},{title:"头像",slot:"headimgurl"},{title:"性别",slot:"sex"},{title:"地区",slot:"country"},{title:"是否关注公众号",slot:"subscribe"},{title:"用户分组",key:"groupid"},{title:"用户标签",key:"tagid_list"},{title:"操作",slot:"createModalFrame",fixed:"right",width:100}],tagList:[],groupList:[],FromData:null,selectionList:[],user_ids:""}},computed:h(h({},Object(n["e"])("media",["isMobile"])),{},{labelWidth:function(){return this.isMobile?void 0:80},labelPosition:function(){return this.isMobile?"top":"right"}}),created:function(){this.getListTag(),this.getList()},methods:{changeMenu:function(t,e){var a=this;switch(e){case"1":this.editGroup("app/wechat/user_group/".concat(t.openid,"/edit"));break;case"2":this.editGroup("app/wechat/user_tag/".concat(t.openid,"/edit"));break;default:var s={title:"同步该用户标签",url:"app/wechat/syn_tag/".concat(t.openid),method:"PUT",ids:""};this.$modalSure(s).then((function(t){a.$Message.success(t.msg),a.getList()})).catch((function(t){a.$Message.error(t.msg)}))}},editGroup:function(t){var e=this;Object(l["a"])(t).then(function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(a){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.FromData=a.data,e.$refs.edits.modals=!0;case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()).catch((function(t){e.$Message.error(t.msg)}))},submitFail:function(){this.getList()},submitModel:function(){this.getList()},onSend:function(){0===this.selectionList.length?this.$Message.warning("请选择要发送优惠券的用户"):(this.$refs.sends.modals=!0,this.$refs.sends.getList())},onSendPic:function(){0===this.selectionList.length?this.$Message.warning("请选择要发送图文消息的用户"):this.modal13=!0},onSelectTab:function(t){this.selectionList=t;var e=[];this.selectionList.map((function(t){e.push(t.uid)})),this.user_ids=e.join(",")},onchangeTime:function(t){this.timeVal=t,this.formValidate.data=this.timeVal.join("-"),this.getList()},selectChange:function(t){this.formValidate.data=t,this.timeVal=[],this.getList()},getListTag:function(){var t=this,e={id:"",name:"全部"};Object(l["b"])().then(function(){var a=Object(r["a"])(regeneratorRuntime.mark((function a(s){var i;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:i=s.data,t.tagList=i.tagList,t.groupList=i.groupList,t.groupList.unshift(e);case 4:case"end":return a.stop()}}),a)})));return function(t){return a.apply(this,arguments)}}()).catch((function(e){t.loading=!1,t.$Message.error(e.msg)}))},getList:function(){var t=this;this.loading=!0,this.formValidate.sex=this.formValidate.sex||"",this.formValidate.subscribe=this.formValidate.subscribe||"",this.formValidate.tagid_list=this.tagidList.join(","),Object(l["k"])(this.formValidate).then(function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(a){var s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:s=a.data,t.tabList=s.list,t.total=s.count,t.loading=!1;case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){t.loading=!1,t.$Message.error(e.msg)}))},pageChange:function(t){this.formValidate.page=t,this.getList()},userSearchs:function(){this.getList()}}},p=f,b=(a("83b5"),a("2877")),g=Object(b["a"])(p,s,i,!1,null,"7e81fbcd",null);e["default"]=g.exports},"83b5":function(t,e,a){"use strict";a("fed6")},fed6:function(t,e,a){}}]);